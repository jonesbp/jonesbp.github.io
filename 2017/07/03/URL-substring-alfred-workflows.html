<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
          <title>Extracting Substrings from URLs with Alfred Workflows ≫ La Tinaja</title>
        

        <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feed.tinaja.computer">

        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />

        <meta name="viewport" content="width=device-width">

        <script src="//use.typekit.net/iei2wij.js"></script>
        <script>try{Typekit.load();}catch(e){}</script>
        
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        
          <meta name="description" content="A couple of simple example Alfred workflows for extracting strings of data from a URL.">
        

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/styles.css">
    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/"><span class="logo icon-tinaja"></span>La Tinaja</a></h1>
            <div class="links">
              <a class="extra" href="/">posts</a>
              <a class="extra" href="/reading">reading</a>
            </div>
            <div class="buttons">
              <a class="button" href="http://brianjon.es" title="About Me">
                <span class="icon-head"></span>
                <span class="invisible-text">Foam Garden</span>
              </a>
              <a class="button" href="http://foamgarden.com" title="Foam Garden">
                <span class="icon-fg"></span>
                <span class="invisible-text">About Me</span>
              </a>
            </div>
          </div>

          
  
    <h2>Extracting Substrings from URLs with Alfred Workflows</h2>
  
  <p class="meta">03 Jul 2017</p>


<div class="post long">
<p>I frequently find myself needing to extract a predictable piece of data from a URL, like a product id, for pasting into a file or database as metadata that might be used to contact an API or construct cleaned-up URLs in the future. The predictable formatting of the part of the URL that I care about makes this the kind of task that perfectly lends itself to simple automation, saving me the small friction of manually editing these URLs in place.</p>

<p><a href="https://www.alfredapp.com/workflows/">Alfred workflows</a> are a quick way to run this category of automation. Because the data is in a URL, I’m typically copying the URL from my web browser to the clipboard and pasting it into a text editor or field. With an Alfred workflow, I can run a script on the text from the clipboard and put my desired result back on the clipboard, cleaned up and ready to paste wherever I’d like.</p>

<p>I have several workflows that fit this general use case, and my interaction with all of them follows the following pattern:</p>

<ul>
  <li><strong>Me:</strong> Copy my starting text to the clipboard</li>
  <li><strong>Me:</strong> Invoke the workflow with an Alfred keyword
    <ul>
      <li><strong>Alfred:</strong> Grab the contents of the clipboard</li>
      <li><strong>Alfred:</strong> Run a short Python script on that data</li>
      <li><strong>Alfred:</strong> Copy the result of the script back to the clipboard</li>
      <li><em>(optionally)</em> <strong>Alfred:</strong> Paste the result of the script to the currently active window</li>
    </ul>
  </li>
  <li><strong>Me:</strong> Paste the text now in the clipboard where I want it if I haven’t already allowed Alfred to do it for me</li>
</ul>

<p>To take a specific example, we can walk through building a workflow to extract the OCLC number for an edition of a book from a <a href="http://worldcat.org">Worldcat.org</a> URL.</p>

<hr />

<p>A typical URL for a book on Worldcat.org reached through their onsite search might look like the following:</p>

<p><code class="highlighter-rouge">http://www.worldcat.org/title/history-and-gis-epistemologies-considerations-and-reflections/oclc/910980341&amp;referer=brief_results</code></p>

<p>The only part I care about are the numerals between <code class="highlighter-rouge">/oclc/</code> and the <code class="highlighter-rouge">&amp;</code> (in this case, <code class="highlighter-rouge">910980341</code>). With that unique identifier I can construct my own tidier Worldcat.org URLs later or use their API in a script.</p>

<hr />

<p><img src="/images/2017/OCLC-workflow-overview.jpg" alt="Complete Alfred Workflow Screenshot" /></p>

<p>The screenshot above shows the final layout of the workflow. Assuming we have the URL on the clipboard, the workflow performs the following actions:</p>

<ol>
  <li>Launch when invoked with the keyword <code class="highlighter-rouge">oclc</code> from Alfred</li>
  <li>Grab the clipboard contents with a bash script</li>
  <li>Take those contents and match them against a simple regular expression (in this case in a Python script)</li>
  <li>Copy to the clipboard and paste in the front most app</li>
</ol>

<h3 id="1-launch">1. Launch</h3>

<p><img src="/images/2017/OCLC-1-launch.jpg" alt="Launch Settings" /></p>

<p>In the Alfred workflow editor, create a new ‘Input’ of the ‘Keyword’ type, select the keyword you would like to use to invoke your workflow, and give it a descriptive title.</p>

<h3 id="2-grab-clipboard">2. Grab Clipboard</h3>

<p>Link your ‘Keyword’ input to a new ’Action’ of type ’Run Script’. You can leave all of the sets for this script alone; the default language choice, <code class="highlighter-rouge">/bin/bash</code>, is what we want in this case. Our script will be a single bash command to grab the contents of the clipboard.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pbpaste
</code></pre></div></div>

<h3 id="3-find-oclc">3. Find OCLC</h3>

<p>Link your <code class="highlighter-rouge">/bin/bash</code> ‘Run Script’ action to a new ’Action’ of type ’Run Script’. This time we will want to change our settings for the Language to <code class="highlighter-rouge">/usr/bin/python</code>. (All we’re doing is matching a regular expression which would be possible using any of the language options. I just like Python.)</p>

<p>The script is simple. We take the input from our bash script that grabbed the clipboard contents and we match it against a regular expression that essentially says “Give me the run of numerals that follow the string <code class="highlighter-rouge">/oclc/</code> in the provided text.” Finally, we write our result to standard output which is how our next Alfred action will receive it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"{query}"</span>

<span class="n">matchObj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'/oclc/([0-9]*)'</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">matchObj</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<p>A couple of things to note:</p>

<ol>
  <li><code class="highlighter-rouge">{query}</code> is a placeholder Alfred looks for in our script in order to insert whatever string of data is coming from the previous action in our workflow. It is not a standard piece of Python syntax.</li>
  <li>A ‘regular expression’ is a string of characters that defines a pattern of text. In the case of the above script, it is the part that reads <code class="highlighter-rouge">/oclc/([0-9]*)</code>, but they can be far more complex. For a good introduction to using regular expressions, you can look at the Google lesson on <a href="https://developers.google.com/edu/python/regular-expressions">Python Regular Expressions</a>.</li>
</ol>

<h3 id="4-output">4. Output</h3>

<p><img src="/images/2017/OCLC-4-output.jpg" alt="Output Settings" /></p>

<p>Finally, we just want to link a new ‘Output’ of type ‘Copy to Clipboard’ and use the default content which is just to pass through the input from our Python script. Depending on the context, we could do additional formatting here by editing the text around <code class="highlighter-rouge">{query}</code>.</p>

<p>In this case, I have also checked the box to ‘Automatically paste to front most app’ because that matches my needs the vast majority of the time I’m using this particular workflow, but in some cases it may be preferable to leave the result on the clipboard without automatically pasting.</p>

<hr />

<p>That’s it. This approach can be repeated for any number of small extraction tasks—to take ASIN numbers from Amazon.com product links in order to construct affiliate links, for example.</p>

<p>Any single instance of this task would be trivial to perform manually, but Alfred’s ability to combine interaction with the clipboard and access to a scripting language with nice regular expression support triggered through a quick-launch command kills the tedious friction of repeat manual editing and becomes second nature.</p>

</div>




    <div class="adjacent-posts">
        
            <div class="link previous">
                <a href="/2017/07/01/recent-reading.html">
                    &laquo; Recent Reading: Zodiacs, Hackers, and Geography
                </a><br>
                <span class="small">01 Jul 2017</span>
            </div>
        

        
            <div class="link next">
                <a href="/2017/07/14/recent-reading.html">
                    Recent Reading: Crowdsourcing, Pots, and GIS &raquo;
                </a><br>
                <span class="small">14 Jul 2017</span>
            </div>
        
        <div class="clear-block"></div>
    </div>




    <div class="other-posts">
    <h3>Other Posts</h3>
    <ul>
    
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
            <li>
                <a href="/2018/01/21/oyster-tecture.html">Media about Cities and Sea Levels</a><br>
                <span class="small">21 Jan 2018</span>
            </li>
            
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
        
    
        
            <li>
                <a href="/2017/10/27/gspread.html">Connecting to Google Sheets with Python</a><br>
                <span class="small">27 Oct 2017</span>
            </li>
            
        
        
    
        
        
    
        
        
    
        
            <li>
                <a href="/2017/10/13/expedience.html">Expedience in <i>Sourdough</i></a><br>
                <span class="small">13 Oct 2017</span>
            </li>
            
        
        
            
    </ul>
</div>




          <div class="footer">
            <div class="contact">
              <p>
                <b>Brian Jones</b><br />
                <a href="http://brianjon.es">brianjon.es</a><br />
                <a href="https://twitter.com/jonesbp">twitter.com/jonesbp</a><br />
                <a href="http://github.com/jonesbp">github.com/jonesbp</a>
              </p>
            </div>
            <div class="contact">

            </div>
            <div class="contact">
              <p>
                <b>Projects</b><br />
                <a href="http://backlist.cc">Backlist</a><br />
                <a href="http://foamgarden.com">Foam Garden</a><br />
                <a href="http://theappendix.net">The Appendix</a>
              </p>
            </div>
            <div>
              <p class="credits">
                <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> <a href="/colophon.html">Colophon</a>
              </p>
            </div>
          </div>
        </div>

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-244154-10', 'auto');
          ga('send', 'pageview');

        </script>
    </body>
</html>
